{
  "common": {
    "workdir": "/workspace/mycode/03-seg/seg/workdir/test",
    "distribute": false,
    "dist_params": {"backend": "nccl", "world_size": 1, "rank": 0, "init_method": "tcp://127.0.0.1:32780"},
    "logger_cfg": {
      "handlers": [
        {
          "type": "StreamHandler",
          "level": "INFO"
        },
        {
          "type": "FileHandler",
          "level": "INFO"
        }
      ]
    },
    "cudnn_deterministic": true,
    "cudnn_benchmark": false,
    "seed": 0,
    "metrics": {}
  },
  "inference": {
    "multi_label": false,
    "transform": [
      {"type": "Resize", "always_apply": true, "width": 512, "height": 512, "padding": 0},
      {"type": "Normalize", "always_apply": true, "scale": 1.0},
      {"type": "ToTensor", "always_apply": true}
    ],
    "model": {
      "type": "EncoderDecoder",
      "pretrained": "/root/.cache/torch/hub/checkpoints/moganet_tiny_sz256_8xbs128_ep300.pth",
      "backbone": {
        "type": "MogaNet",
        "arch": "tiny",
        "num_classes": null,
        "out_levels": [0, 1, 2, 3]
      },
      "decoder_head": {
        "type": "DLAHead",
        "in_channels": [32, 64, 128, 256],
        "down_ratio": 2,
        "num_classes": 11,
        "align_corners": false,
        "norm_cfg": {"type": "BN"},
        "act_cfg": {"type": "xUnitS"},
        "loss": [
          {
            "type": "AutoSegLoss",
            "parameterization": "bezier",
            "theta": [
              0.00056972844,
              0.64372045,
              0.338589169,
              0.70554336,
              0.625281252,
              0.779551927,
              0.69037557,
              0.01306289,
              0.834170515,
              0.962431815,
              0.942998269,
              0.980038125
            ]
          },
          {"type": "CrossEntropyLoss"}
        ]
      },
      "parameterization": "bezier",
      "auxiliary_head": [
        {
          "type": "FCNHead",
          "in_channels": 256,
          "num_convs": 1,
          "head_width": 256,
          "in_index": -1,
          "loss": [
            {
              "type": "LovaszLoss",
              "loss_weight": 0.4
            },
            {
              "type": "CrossEntropyLoss",
              "loss_weight": 0.4
            }
          ]
        },
        {
          "type": "FCNHead",
          "in_channels": 128,
          "num_convs": 1,
          "head_width": 256,
          "in_index": -2,
          "loss": [
            {
              "type": "LovaszLoss",
              "loss_weight": 0.4
            },
            {
              "type": "CrossEntropyLoss",
              "loss_weight": 0.4
            }
          ]
        },
        {
          "type": "FCNHead",
          "in_channels": 64,
          "num_convs": 1,
          "head_width": 256,
          "in_index": -3,
          "loss": [
            {
              "type": "LovaszLoss",
              "loss_weight": 0.4
            },
            {
              "type": "CrossEntropyLoss",
              "loss_weight": 0.4
            }
          ]
        }
      ]
    }
  },
  "data": {
    "ImageNetMeanStd": true,
    "train": {
      "transform": [
          {"type": "HorizontalFlip", "p": 0.3},
          {"type": "VerticalFlip", "p": 0.3},
          {"type": "CenterFlip", "p": 0.3},
          {"type": "Rotate", "p": 0.3, "limit": 15},
          {"type": "ColorJitter", "p": 0.3, "contrast": 0.2, "brightness": 0.2, "saturation": 0.2, "hue": 0.2},
          {"type": "RandomCrop", "p": 0.3, "height_ratio": 0.98, "width_ratio": 0.98, "crop_height": 0, "crop_width": 0},
          {"type": "CenterCrop", "p": 0.3, "height_ratio": 0.98, "width_ratio": 0.98, "crop_height": 0, "crop_width": 0},
          {"type": "MultiplicativeNoise", "p": 0.3, "multiplier":[0.9,1.1]},
          {"type": "GaussNoise", "p": 0.3, "mean": 0, "var_limit": 50},
          {"type": "Resize", "width": 512, "height": 512, "always_apply": true},
          {"type": "Normalize", "always_apply": true, "scale": 1.0},
          {"type": "ToTensor", "always_apply": true}
      ],
      "dataset": {
        "type": "LabelMe",
        "root": "/workspace/mycode/03-seg/seg/local/labelme",
        "mode": "train",
        "shape_labels": [
          "A",
          "B",
          "C",
          "D"
        ]
      },
      "dataloader": {
        "type": "DataLoader",
        "samples_per_gpu": 1,
        "workers_per_gpu": 1,
        "shuffle": true,
        "drop_last": true,
        "pin_memory": true
      }
    },
    "valid": {
      "transform": [
          {"type": "Resize", "width": 512, "height": 512, "always_apply": true},
          {"type": "Normalize", "always_apply": true, "scale": 1.0},
          {"type": "ToTensor", "always_apply": true}
        ],
      "dataset": {
        "type": "LabelMe",
        "root": "/workspace/mycode/03-seg/seg/local/labelme",
        "mode": "valid",
        "shape_labels": [
          "A",
          "B",
          "C",
          "D"
        ]
      },
      "dataloader": {
        "type": "DataLoader",
        "samples_per_gpu": 1,
        "workers_per_gpu": 1,
        "shuffle": false,
        "drop_last": false,
        "pin_memory": true
      }
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.001,
      "weight_decay": 0.00202158
    },
    "max_epochs": 120,
    "lr_scheduler": {
      "type": "CosineAnnealingWarmRestarts",
      "T_0": 40,
      "eta_min": 1e-8
    },
    "select_metric": "iou",
    "save_infer_image": false
  },
  "export": {
    "onnx": {"opset_version": 17},
    "trt": {
      "max_batch_size": 32,
      "mode": "fp16"
    }
  }
}